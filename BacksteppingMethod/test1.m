% Description: None
% Author: Bin Peng
% Email: pb20020816@163.com
% Date: 2024-12-15 15:54:45
% LastEditTime: 2024-12-15 19:42:45
clear
syms u v w freq amp bias u_dot v_dot w_dot k_1 k_r r theta real


u=0.2;v=0.000;w=0;r=5;theta=pi/50;amp=30;freq=1;
k_r = (30 - sqrt(30-1))/2
k_1 = 0.25/k_r
thrust_part1 = (0.0514 * exp(0.03102 * (freq - 0.4961)^2) - ...
          1.7630 * exp(-2.2080 * (freq - 1.8670)^2) - ...
          0.8956 * exp(-1.9130 * (freq - 1.0820)^2));
thrust_part2 = ((v*cos(theta) + u*sin(theta))*(w + (v*cos(theta))/r + (u*sin(theta))/r) - 1.0*sin(theta)*(0.024309390060648402687884086858897*u - 0.74229599144516638561745720300377*v + 0.68030057029160631256205361775987*w + 0.067412500696260895256598449361081*w*(13.8238*u + 0.0279*v - 2.4948*w - 9.2471) - 0.09297788244746423471491001773451*v*(13.8238*u + 0.0279*v - 2.4948*w - 6.5004) - 0.09297788244746423471491001773451*u*(0.1103*u - 30.9448*v - 12.8666*w + 0.2295) + 0.00019039183056524293459228042798975*w*(0.1103*u - 30.9448*v - 12.8666*w + 1.9539)) + cos(theta)*(0.0072140877996593715018339147058815*w*(13.8238*u + 0.0279*v - 2.4948*w - 9.2471) - 0.2003144416991875090936946356628*v - 0.021288079293693457416525574199766*w - 0.026428325163817343131666137978312*u + 0.0029094794573711810376839020063096*v*(13.8238*u + 0.0279*v - 2.4948*w - 6.5004) + 0.0029094794573711810376839020063096*u*(0.1103*u - 30.9448*v - 12.8666*w + 0.2295) + 0.048435605693185345941928894723571*w*(0.1103*u - 30.9448*v - 12.8666*w + 1.9539)) - 1.0*(u*cos(theta) - 1.0*v*sin(theta))*(k_1 + k_r) + k_1*k_r*r)/(cos(theta)*(0.0075050357453964896056023049065124*bias*thrust_part1 - 0.048435605693185345941928894723571*thrust_part1*(0.5*bias^2 - 1.0)) - 1.0*sin(theta)*(0.05811471245151447178510744758763*bias*thrust_part1 - 0.00019039183056524293459228042798975*thrust_part1*(0.5*bias^2 - 1.0)));

eq3 = thrust_part2 == (0.0085 * amp^2 - 0.6171 * amp + 4.0280)
vpa(eq3,5)

solution3 = solve(eq3, bias);
solution3_float = vpa(solution3);
disp(solution3_float);
